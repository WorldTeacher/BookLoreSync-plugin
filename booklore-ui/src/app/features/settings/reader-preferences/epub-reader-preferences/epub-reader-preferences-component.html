<div class="epub-preferences-container">

  <div class="settings-group">
    <h3 class="group-title">Appearance</h3>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Theme</label>
          <div class="theme-selector">
            @for (theme of themes; track theme) {
              <button
                type="button"
                class="theme-option"
                [class.selected]="selectedTheme === theme.name"
                (click)="selectedTheme = theme.name"
                [attr.aria-label]="theme.label"
                [pTooltip]="theme.label"
                tooltipPosition="bottom">
                <span class="theme-colors">
                  <span class="theme-color" [style.background-color]="theme.light.bg"></span>
                  <span class="theme-color" [style.background-color]="theme.dark.bg"></span>
                </span>
                @if (selectedTheme === theme.name) {
                  <i class="pi pi-check"></i>
                }
              </button>
            }
          </div>
        </div>
        <p class="setting-description">
          Select a color scheme to match your reading environment and comfort.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Dark Mode</label>
          <div class="button-group">
            <button
              type="button"
              class="option-button"
              [class.selected]="!isDark"
              (click)="isDark = false">
              <i class="pi pi-sun"></i>
              <span class="option-text">Light</span>
            </button>
            <button
              type="button"
              class="option-button"
              [class.selected]="isDark"
              (click)="isDark = true">
              <i class="pi pi-moon"></i>
              <span class="option-text">Dark</span>
            </button>
          </div>
        </div>
        <p class="setting-description">
          Switch between light and dark backgrounds for day or night reading.
        </p>
      </div>
    </div>
  </div>

  <div class="settings-group">
    <h3 class="group-title">Typography</h3>
    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Font Family</label>
          <div class="button-group">
            @for (font of fonts; track font) {
              <button
                type="button"
                class="option-button font-button"
                [class.selected]="selectedFont === font.key"
                [class.separator]="font.key === 'separator'"
                [attr.data-font]="font.key"
                [disabled]="font.key === 'separator'"
                (click)="selectedFont = font.key"
                [pTooltip]="font.name"
                tooltipPosition="bottom">
                <span class="option-text" [style.font-family]="font.key && font.key.startsWith('custom:') ? getCustomFontName(font.key) : null">
                  {{ font.displayName }}
                </span>
              </button>
            }

            @if (!customFontsReady) {
              <p-skeleton width="3.5rem" height="2.5rem" borderRadius="6px"></p-skeleton>
            }
          </div>
        </div>
        <p class="setting-description">
          Choose a typeface that best suits your reading preference.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Font Size</label>
          <div class="font-size-controls">
            <p-button icon="pi pi-minus" size="small" rounded outlined (click)="decreaseFontSize()"></p-button>
            <span class="font-size-value">{{ fontSize }}pt</span>
            <p-button icon="pi pi-plus" size="small" rounded outlined (click)="increaseFontSize()"></p-button>
          </div>
        </div>
        <p class="setting-description">
          Increase or decrease text size in points for optimal readability.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Line Height</label>
          <div class="font-size-controls">
            <p-button icon="pi pi-minus" size="small" rounded outlined (click)="decreaseLineHeight()"></p-button>
            <span class="font-size-value">{{ lineHeight.toFixed(1) }}</span>
            <p-button icon="pi pi-plus" size="small" rounded outlined (click)="increaseLineHeight()"></p-button>
          </div>
        </div>
        <p class="setting-description">
          Adjust vertical spacing between lines for better legibility.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Text Justification</label>
          <div class="button-group">
            <button
              type="button"
              class="option-button"
              [class.selected]="!justify"
              (click)="justify = false">
              <i class="pi pi-align-left"></i>
              <span class="option-text">Left</span>
            </button>
            <button
              type="button"
              class="option-button"
              [class.selected]="justify"
              (click)="justify = true">
              <i class="pi pi-align-justify"></i>
              <span class="option-text">Justified</span>
            </button>
          </div>
        </div>
        <p class="setting-description">
          Align text to the left or justify it for a clean edge on both sides.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Hyphenation</label>
          <div class="button-group">
            <button
              type="button"
              class="option-button"
              [class.selected]="!hyphenate"
              (click)="hyphenate = false">
              <i class="pi pi-times"></i>
              <span class="option-text">Off</span>
            </button>
            <button
              type="button"
              class="option-button"
              [class.selected]="hyphenate"
              (click)="hyphenate = true">
              <i class="pi pi-check"></i>
              <span class="option-text">On</span>
            </button>
          </div>
        </div>
        <p class="setting-description">
          Enable to break long words at line ends for a smoother text flow.
        </p>
      </div>
    </div>
  </div>

  <div class="settings-group">
    <h3 class="group-title">Layout</h3>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Flow</label>
          <div class="button-group">
            <button
              type="button"
              class="option-button"
              [class.selected]="flow === 'paginated'"
              (click)="flow = 'paginated'">
              <i class="pi pi-clone"></i>
              <span class="option-text">Paginated</span>
            </button>
            <button
              type="button"
              class="option-button"
              [class.selected]="flow === 'scrolled'"
              (click)="flow = 'scrolled'">
              <i class="pi pi-arrows-v"></i>
              <span class="option-text">Scrolled</span>
            </button>
          </div>
        </div>
        <p class="setting-description">
          Choose between paginated (page-by-page) or continuous scrolling flow.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Max Columns</label>
          <div class="font-size-controls">
            <p-button icon="pi pi-minus" size="small" rounded outlined (click)="maxColumnCount = maxColumnCount > 1 ? maxColumnCount - 1 : 1"></p-button>
            <span class="font-size-value">{{ maxColumnCount }}</span>
            <p-button icon="pi pi-plus" size="small" rounded outlined (click)="maxColumnCount = maxColumnCount < 4 ? maxColumnCount + 1 : 4"></p-button>
          </div>
        </div>
        <p class="setting-description">
          Set how many columns the text is split into on wide screens.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Column Gap</label>
          <div class="font-size-controls">
            <p-button icon="pi pi-minus" size="small" rounded outlined (click)="decreaseGap()"></p-button>
            <span class="font-size-value">{{ gap }}px</span>
            <p-button icon="pi pi-plus" size="small" rounded outlined (click)="increaseGap()"></p-button>
          </div>
        </div>
        <p class="setting-description">
          Control the space between columns for a balanced layout.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Max Width</label>
          <div class="font-size-controls">
            <p-button icon="pi pi-minus" size="small" rounded outlined (click)="decreaseMaxInlineSize()"></p-button>
            <span class="font-size-value">{{ maxInlineSize }}px</span>
            <p-button icon="pi pi-plus" size="small" rounded outlined (click)="increaseMaxInlineSize()"></p-button>
          </div>
        </div>
        <p class="setting-description">
          Limit the maximum width of the reading area for easier line tracking.
        </p>
      </div>
    </div>

    <div class="setting-item">
      <div class="setting-info">
        <div class="setting-label-row">
          <label class="setting-label">Max Height</label>
          <div class="font-size-controls">
            <p-button icon="pi pi-minus" size="small" rounded outlined (click)="decreaseMaxBlockSize()"></p-button>
            <span class="font-size-value">{{ maxBlockSize }}px</span>
            <p-button icon="pi pi-plus" size="small" rounded outlined (click)="increaseMaxBlockSize()"></p-button>
          </div>
        </div>
        <p class="setting-description">
          Limit the maximum height of the reading area to fit your screen.
        </p>
      </div>
    </div>
  </div>
</div>
